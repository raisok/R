library("Mfuzz")
data<-table2eset("AAAA.union.matrix")
data.r <- filter.NA(data, thres=0.25)
data.m <- fill.NA(data.r,mode="mean")
data.f <- filter.std(data.m,min.std=0.05,visu=F)
data.s <- standardise(data.f)
cl <- mfuzz(data.s,c=16,m=1.25)
pdf("AAAA.mfuzz.plot.pdf",width=7,height=9)
mfuzz.plot2(data.s,cl=cl,mfrow=c(4,4),min.mem=0.75,time.labels=c("SZ_150_24h_1","SZ_150_24h_2","SZ_150_24h_3","R6_12h_1","R6_12h_2","R6_12h_3","R59_12h_1","R59_12h_2","R59_12h_3","SZ_150_12h_1","SZ_150_12h_2","SZ_150_12h_3","R6_24h_1","R6_24h_2","R6_24h_3","R59_24h_1","R59_24h_2","R59_24h_3"),x11 = FALSE)
dev.off()
pdf("AAAA.mfuzz.plot.split.pdf",width=7,height=9)
mfuzz.plot2(data.s,cl=cl,mfrow=c(1,1),min.mem=0.75,time.labels=c("SZ_150_24h_1","SZ_150_24h_2","SZ_150_24h_3","R6_12h_1","R6_12h_2","R6_12h_3","R59_12h_1","R59_12h_2","R59_12h_3","SZ_150_12h_1","SZ_150_12h_2","SZ_150_12h_3","R6_24h_1","R6_24h_2","R6_24h_3","R59_24h_1","R59_24h_2","R59_24h_3"),x11 = FALSE)
cluster<-cl$cluster
membership<-cl$membership
expStandard<-exprs(data.s)
write.csv(membership,file="AAAA.membership")
write.csv(cluster,file="AAAA.cluster")
write.csv(expStandard,file="AAAA.expStandard")
dev.off()
